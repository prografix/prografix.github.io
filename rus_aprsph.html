<html>
<head><title>Аппроксимация точек сферой</title>
<link rel="stylesheet" type="text/css" href="stylle.css"></head>
<style type="text/css">
 p { MARGIN-TOP: 0mm; TEXT-ALIGN: justify }
</style>
<body bgcolor=#eeeeba MARGINWIDTH=0 MARGINHEIGHT=0 link=#0000F0 alink=#aaaaFF vlink=#339900>
<div align="center"><center>
<table width="800" cellspacing="0" cellpadding="0">
<div align=center><br>
<font color="" style="font-size: 20pt">
Аппроксимация точек сферой
</font>
</div>
<br>
<div align=left><td>
<p>Пусть в пространстве дано множество из n точек p<SUB><I>i</I></SUB> = ( x<SUB><I>i</I></SUB>, y<SUB><I>i</I></SUB>, z<SUB><I>i</I></SUB> ) 
и нужно аппроксимировать его сферой.
Рассмотрим несколько подходов к решению этой задачи.
В первом подходе координаты центра o = ( x, y, z ) и радиус r будем искать, как аргументы при которых функция
</p>
<table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD>
    <TD noWrap>( r<SUP> 2</SUP> - ( x - x<SUB><I>i</I></SUB> )<SUP> 2</SUP>
								- ( y - y<SUB><I>i</I></SUB> )<SUP> 2</SUP>
								- ( z - z<SUB><I>i</I></SUB> )<SUP> 2</SUP>
			)<SUP> 2</SUP> <TD colSpan=3>&nbsp;<TD>&nbsp;&nbsp;&nbsp;&nbsp;(1)</TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=680 cellspacing=0 cellpadding=0>
<br>
<p>принимает минимальное значение. 
Сведём эту задачу к задаче наименьших квадратов. Для этого продифференцируем (1)
по r и приравняем производную нулю. Отсюда получим выражение r<SUP> 2</SUP> через x, y и z:
</p>
<table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD >r<SUP> 2</SUP> = &nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD>
    <TD noWrap>( ( x - x<SUB><I>i</I></SUB> )<SUP> 2</SUP> +
				 ( y - y<SUB><I>i</I></SUB> )<SUP> 2</SUP> +
				 ( z - z<SUB><I>i</I></SUB> )<SUP> 2</SUP>
			)<TD colSpan=3>&nbsp;<TD>&nbsp;&nbsp;&nbsp;&nbsp;(2)</TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=680 cellspacing=0 cellpadding=0>
<BR>
<p>Подставим это выражение в (1) и приведём подобные члены. 
Получится <a href="rus_lss.html">задача наименьших квадратов</a>:
</p>
</table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD>
    <TD noWrap>( 2 ( x<SUB><I>i</I></SUB> - <SPAN class=over>x</SPAN> ) x +
				 2 ( y<SUB><I>i</I></SUB> - <SPAN class=over>y</SPAN> ) y +
				 2 ( z<SUB><I>i</I></SUB> - <SPAN class=over>z</SPAN> ) z +
				 <SPAN class=over>xx</SPAN> - x<SUB><I>i</I></SUB><SUP> 2</SUP> +
				 <SPAN class=over>yy</SPAN> - y<SUB><I>i</I></SUB><SUP> 2</SUP> +
				 <SPAN class=over>zz</SPAN> - z<SUB><I>i</I></SUB><SUP> 2</SUP>
			)<SUP> 2</SUP> <TD colSpan=3>&nbsp;<TD>&nbsp;&nbsp;&nbsp;&nbsp;(3)</TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=680 cellspacing=0 cellpadding=0>
<p>где
</p>
</table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>x</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>x<SUB><I>i</I></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>y</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>y<SUB><I>i</I></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>z</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>z<SUB><I>i</I></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>xx</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>x<SUB><I>i</I></SUB><SUP>2</SUP></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>yy</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>y<SUB><I>i</I></SUB><SUP>2</SUP></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD noWrap><SPAN class=over>zz</SPAN> =&nbsp;</TD>
    <TD noWrap align=middle>1 <P class=over>n</P></TD>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD><TD>z<SUB><I>i</I></SUB><SUP>2</SUP></TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD colSpan=2>&nbsp;</TD>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=680 cellspacing=0 cellpadding=0>
<p>Следующая программа решает эту задачу:
</p>
<pre>Def&lt;Sphere3d> getSpherePnt22 ( CArrRef&lt;Vector3d> p );
</pre>
<p>Основное преимущество рассмотренной задачи - это простота решения, но более интересной для практики
является минимизация другой функции отклонений:
<table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD>
    <TD noWrap> ( | o - p<SUB><I>i</I></SUB> |<SUB>2</SUB> - r )
			<SUP> 2</SUP> <TD colSpan=3>&nbsp;<TD>&nbsp;&nbsp;&nbsp;&nbsp;(4)</TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=800 cellspacing=0 cellpadding=0>
О векторных нормах смотрите <a href=normv.html>здесь</a>.
Эту формулу можно переписать так:
</table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR style="POSITION: relative; TOP: 12%" align=middle>
    <TD><FONT size=-1><I>n</I></FONT></TD>
  </TR>
  <TR>
    <TD align=middle><FONT size=+3>&#8721;</FONT></TD>
    <TD noWrap> ( cx<SUB><I>i</I></SUB> * ( х - x<SUB><I>i</I></SUB> ) + cy<SUB><I>i</I></SUB> * ( y - y<SUB><I>i</I></SUB> )
	 + cz<SUB><I>i</I></SUB> * ( z - z<SUB><I>i</I></SUB> ) - r )
			<SUP> 2</SUP> <TD colSpan=3>&nbsp;<TD>&nbsp;&nbsp;&nbsp;&nbsp;(5)</TD>
  </TR>
  <TR style="POSITION: relative; TOP: -3%" align=middle>
    <TD><FONT size=-1><I>i</I> = 1</FONT></TD>
  </TR>
 </TBODY></TABLE>
<table width=800 cellspacing=0 cellpadding=0>
где
</table>
<TABLE cellSpacing=2 cellPadding=0 align=center border=0>
  <TBODY>
  <TR>
    <TD noWrap>cx<SUB><I>i</I></SUB> = ( х - x<SUB><I>i</I></SUB> ) / | o - p<SUB><I>i</I></SUB> |<SUB>2</SUB></TD>
  </TR>
  <TR>
	<TD noWrap>cy<SUB><I>i</I></SUB> = ( y - y<SUB><I>i</I></SUB> ) / | o - p<SUB><I>i</I></SUB> |<SUB>2</SUB></TD>
  </TR>
  <TR>
	<TD noWrap>cz<SUB><I>i</I></SUB> = ( z - z<SUB><I>i</I></SUB> ) / | o - p<SUB><I>i</I></SUB> |<SUB>2</SUB></TD>
  </TR>
 </TBODY></TABLE>
<table width=800 cellspacing=0 cellpadding=0>
Если считать в формуле (5) переменные cx<SUB><I>i</I></SUB>, cy<SUB><I>i</I></SUB> и cz<SUB><I>i</I></SUB> известными, 
то приходим к классической задаче МНК. 
<br>Отсюда получается следующий итерационный алгоритм:
<br>1) Получаем начальное приближение для o и r при помощи функции getSpherePnt22. 
<br>2) Вычисляем значения cx<SUB><I>i</I></SUB>, cy<SUB><I>i</I></SUB> и cz<SUB><I>i</I></SUB>.
<br>3) Решая задачу (5) получаем новые значения для o и r.
<br>Будем повторять шаги 2 и 3 пока алгоритм не сойдётся.
В результате получаем программу:
<pre>Def&lt;Sphere3d> getSpherePnt2 ( CArrRef&lt;Vector3d> p );
</pre>
</p>
<p>Описание класса Vector3d находится <a href="rus_vector.html">здесь</a>.
<br>Описание класса Sphere3d находится <a href="figure3d.html">здесь</a>.
<br>Описание шаблона классов Def находится <a href=def.html>здесь</a>.
<br>Описание шаблона классов CArrRef находится <a href=array.html>здесь</a>.
</p>
<p>Исходники находятся в файле <a href="source/source.zip">approx3d.cpp</a></p>
<a href="rus_approx.html">Наверх</a>
<pre>

</pre>
</td></div>
</table>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10825496-1");
pageTracker._trackPageview();
} catch(err) {}
</script>
</body>
</html>
